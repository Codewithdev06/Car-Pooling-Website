<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Car Pooling | Home</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="style.css" />

    <!-- React & Babel CDN -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body>
    <div id="root"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- React App -->
    <script type="text/babel">
      const { useState } = React;

      function Navbar() {
        return (
          <nav className="navbar navbar-expand-lg navbar-light bg-light">
            <div className="container-fluid">
              <a className="navbar-brand" href="index.html">üöó CarPool</a>
              <button
                className="navbar-toggler"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#navbarNav"
              >
                <span className="navbar-toggler-icon"></span>
              </button>
              <div className="collapse navbar-collapse" id="navbarNav">
                <ul className="navbar-nav ms-auto">
                  <li className="nav-item"><a className="nav-link" href="index.html">Home</a></li>
                  <li className="nav-item"><a className="nav-link" href="find.html">Find a Ride</a></li>
                  <li className="nav-item"><a className="nav-link" href="rides.html">Rides</a></li>
                  <li className="nav-item"><a className="nav-link" href="contact.html">Contact</a></li>
                  <li className="nav-item"><a className="nav-link" href="signup.html">Sign Up</a></li>
                  <li className="nav-item"><a className="nav-link" href="login.html">Login</a></li>
                </ul>
              </div>
            </div>
          </nav>
        );
      }

      function Hero() {
        return (
          <section className="hero bg-primary text-white text-center py-5">
            <div className="container">
              <h2 className="display-4">Share Your Ride, Save the Planet</h2>
              <p className="lead">Find carpool partners, save money, and reduce traffic together.</p>
              <a href="find.html" className="btn btn-light btn-lg">Find a Ride</a>
            </div>
          </section>
        );
      }

      function WeatherSection() {
        const [city, setCity] = useState("");
        const [data, setData] = useState(null);
        const [chart, setChart] = useState(null);
        const apiKey = "ab03e1a780bdf5ee50a0eaebb10e2c4b";

        async function checkWeather(cityName) {
          if (!cityName) return alert("Please enter a city name");
          const response = await fetch(
            `https://api.openweathermap.org/data/2.5/weather?units=metric&q=${cityName}&appid=${apiKey}`
          );
          if (response.status === 404) {
            alert("City not found");
            return;
          }
          const weatherData = await response.json();
          setData(weatherData);
          updateChart(weatherData);
        }

        function updateChart(weatherData) {
          const ctx = document.getElementById("weatherChart").getContext("2d");
          if (chart) chart.destroy();
          const newChart = new Chart(ctx, {
            type: "bar",
            data: {
              labels: ["Temperature (¬∞C)", "Humidity (%)", "Wind Speed (km/h)"],
              datasets: [
                {
                  label: `Weather Data for ${weatherData.name}`,
                  data: [
                    weatherData.main.temp,
                    weatherData.main.humidity,
                    weatherData.wind.speed,
                  ],
                  backgroundColor: ["#ff6384", "#36a2eb", "#ffce56"],
                  borderRadius: 10,
                },
              ],
            },
            options: {
              responsive: true,
              plugins: {
                title: {
                  display: true,
                  text: `Weather Chart - ${weatherData.name}`,
                  color: "#000",
                },
              },
              scales: { y: { beginAtZero: true } },
            },
          });
          setChart(newChart);
        }

        return (
          <section className="container my-5 text-center">
            <h3 className="h3 mb-4">üå§Ô∏è Check Weather Before You Ride</h3>
            <div className="card-weather mx-auto" style={{ maxWidth: "450px" }}>
              <div className="search d-flex justify-content-center mb-3">
                <input
                  type="text"
                  className="form-control me-2"
                  placeholder="Enter City Name"
                  spellCheck="false"
                  value={city}
                  onChange={(e) => setCity(e.target.value)}
                  onKeyDown={(e) => e.key === "Enter" && checkWeather(city)}
                  style={{ width: "70%" }}
                />
                <button className="btn btn-primary" onClick={() => checkWeather(city)}>
                  <img
                    src="https://static.vecteezy.com/system/resources/previews/015/337/677/non_2x/transparent-search-icon-free-png.png"
                    alt="search"
                    width="20"
                  />
                </button>
              </div>

              <div className="weather">
                <img
                  src={
                    data
                      ? data.weather[0].main === "Clouds"
                        ? "https://tse1.mm.bing.net/th/id/OIP.6YLwhqTAp4Xh5o22CK_u5QHaHa?pid=Api&P=0&h=180"
                        : data.weather[0].main === "Clear"
                        ? "https://tse1.mm.bing.net/th/id/OIP.8fHU00AwfjeRlSkfPwPuQAAAA?pid=Api&P=0&h=180"
                        : data.weather[0].main === "Rain"
                        ? "https://static.vecteezy.com/system/resources/previews/000/450/651/original/rain-vector-icon.jpg"
                        : "https://cdn2.iconfinder.com/data/icons/weather-flat-14/64/weather02-1024.png"
                      : "https://cdn2.iconfinder.com/data/icons/weather-flat-14/64/weather02-1024.png"
                  }
                  className="weather-icon"
                  alt="weather icon"
                  width="80"
                />
                <h1 className="temp">{data ? `${Math.round(data.main.temp)}¬∞C` : "--¬∞C"}</h1>
                <h2 className="city">{data ? data.name : "Search City"}</h2>
                <div className="details d-flex justify-content-around mt-3">
                  <div className="col text-center">
                    <img
                      src="https://cdn-icons-png.flaticon.com/512/578/578135.png"
                      alt="humidity"
                      width="30"
                    />
                    <div>
                      <p className="humidity">{data ? `${data.main.humidity}%` : "--%"}</p>
                      <p>Humidity</p>
                    </div>
                  </div>
                  <div className="col text-center">
                    <img
                      src="http://clipartlibrary.com/images_k/wind-clipart-transparent/wind-clipart-transparent-19.png"
                      alt="wind"
                      width="30"
                    />
                    <div>
                      <p className="wind">{data ? `${data.wind.speed} km/h` : "-- km/h"}</p>
                      <p>Wind Speed</p>
                    </div>
                  </div>
                </div>
              </div>
              <canvas id="weatherChart" className="mt-4"></canvas>
            </div>
          </section>
        );
      }

      function Features() {
        return (
          <section className="container my-5">
            <div className="row row-cols-1 row-cols-md-3 g-4">
              <div className="col">
                <div className="card h-100 shadow-sm border-0 text-center">
                  <div className="card-body">
                    <h3 className="card-title">üöó Easy Ride Sharing</h3>
                    <p className="card-text">
                      Connect with trusted people in your city to share daily rides.
                    </p>
                  </div>
                </div>
              </div>
              <div className="col">
                <div className="card h-100 shadow-sm border-0 text-center">
                  <div className="card-body">
                    <h3 className="card-title">üí∞ Save Money</h3>
                    <p className="card-text">
                      Split travel costs and save on fuel and maintenance expenses.
                    </p>
                  </div>
                </div>
              </div>
              <div className="col">
                <div className="card h-100 shadow-sm border-0 text-center">
                  <div className="card-body">
                    <h3 className="card-title">üåç Eco-Friendly</h3>
                    <p className="card-text">
                      Reduce your carbon footprint by sharing rides and cutting traffic.
                    </p>
                  </div>
                </div>
              </div>
            </div>
          </section>
        );
      }

      function Footer() {
        return (
          <footer className="bg-light text-center py-3 mt-5">
            <p className="mb-0">&copy; 2025 CarPool. All rights reserved.</p>
          </footer>
        );
      }

      function App() {
        return (
          <>
            <Navbar />
            <Hero />
            <WeatherSection />
            <Features />
            <Footer />
          </>
        );
      }

      ReactDOM.createRoot(document.getElementById("root")).render(<App />);
    </script>
  </body>
</html>
